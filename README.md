# シフト調整システム

バイトスタッフのシフト希望提出と管理者によるシフト調整・確定を行うWebアプリケーションです。スマートフォンでの操作を前提とした使いやすいUIになっています。

## 主な機能

### スタッフ向け機能
- **希望シフトの提出**
  - **複数日付を同時選択可能**（カレンダー形式で選択）
  - カレンダーに既存シフトを色分け表示
    - 黄色：希望シフト（未承認・承認済み）
    - 赤色：確定シフト
  - 月の切り替え（過去の日付は選択不可）
  - 開始・終了時刻の選択（9:30-18:00の範囲で30分刻み）
  - 備考・メモの記入
  - 選択したすべての日付に同じ時間帯のシフトを一括提出
  - 提出済みの希望シフト一覧表示
  - ステータス確認（確認中/承認済み）

- **確定シフトの確認**
  - 自分に割り当てられたシフトの表示
  - 月単位でのフィルター機能
  - 勤務時間と備考の確認

- **カレンダー表示**
  - 月間カレンダー形式でのシフト表示
  - 希望シフト（黄色）と確定シフト（赤色）を同時表示
  - コンパクトで見やすいデザイン
  - 複数シフトがあってもスクロール不要
  - 色分けのみでシフトの種類を直感的に識別
  - ホバーでステータス（未承認/承認済み/確定）を確認
  - 自分のシフトが一目で確認可能
  - 空白日をクリックして新規シフトを素早く作成

### 管理者向け機能
- **希望シフト管理**
  - 全スタッフの希望シフト一覧表示
  - 日付・ステータスでフィルター
  - 希望シフトの承認
  - 希望シフトの承認取り消し
  - シフト調整機能（時間帯の編集）
  - 希望シフトの削除

- **シフト作成・管理**
  - スタッフへのシフト割り当て
  - 日付・時間帯の指定
  - 備考・メモの追加
  - 月単位での一覧表示
  - シフトの削除

- **ユーザー管理**
  - 新規ユーザーの追加
  - ユーザー情報の編集
  - ユーザーの削除
  - パスワードの設定・変更

- **シフト管理（カレンダー表示）**
  - 月・スタッフでフィルタリング
  - 希望シフト（黄色）と確定シフト（赤色）を同時表示
  - シフトをクリックして直接編集・承認・削除
  - 週ごとの合計時間表示（日～土区切り）
  - 空白日をクリックして新規シフトを素早く作成
  
- **カレンダー（全体表示）**
  - 未承認の希望シフトカレンダー
  - 承認済み・確定シフトカレンダー
  - スタッフ名と時間帯が一目で確認可能
  - PC画面での閲覧を推奨

### 共通機能
- パスワード認証によるログイン
- スマートフォン対応レスポンシブデザイン
- 直感的で使いやすいUI

## 使い方

### 初回ログイン
1. トップページ（`index.html`）にアクセス
2. ユーザーを選択
3. パスワードを入力してログイン

**デフォルトユーザーと初期パスワード**

| ユーザー名 | 役割 | パスワード |
|-----------|------|-----------|
| 管理者 | 管理者 | `admin123` |
| 田中太郎 | スタッフ | `tanaka123` |
| 佐藤花子 | スタッフ | `sato123` |
| 鈴木一郎 | スタッフ | `suzuki123` |

※パスワードは管理者画面のユーザー管理から変更可能です

### スタッフの操作手順
1. ログイン後、スタッフページが表示されます
2. **希望シフト提出タブ**
   - カレンダーから希望日を**複数選択**（クリックして青色にする）
   - ◀▶ボタンで月を切り替え可能
   - 選択した日付は下部に表示され、クリックで解除可能
   - 開始時刻と終了時刻を選択（9:30-18:00、30分刻み）
   - 備考があれば入力
   - 「選択した日付すべてに希望シフトを提出」ボタンをクリック
   - 選択したすべての日付に同じ時間帯のシフトが一括作成されます
   - 提出済みの希望シフトが下部に表示されます
3. **確定シフトタブ**
   - 表示月を選択
   - 確定したシフトが一覧表示されます
4. **カレンダータブ**
   - 月間カレンダーで自分のシフトを確認

### 管理者の操作手順
1. ログイン後、管理者ページが表示されます
2. **希望シフト一覧タブ**
   - スタッフからの希望シフトが一覧表示されます
   - 日付やステータスでフィルター可能
   - 「承認」ボタンで承認
   - 「調整」ボタンで時間帯を編集してシフト作成
   - 「削除」ボタンで希望シフトを削除
   - 承認済みのシフトは「承認取消」で未承認に戻せます
3. **シフト管理タブ**（最重要）
   - 月とスタッフでフィルタリング
   - カレンダーに希望シフト（黄色）と確定シフト（赤色）を同時表示
   - シフトをクリックして編集・承認・削除
   - 週ごとの合計時間表示（希望・確定それぞれ）
   - 空白日をクリックして新規シフトを作成
4. **シフト作成タブ**
   - 新しいシフトを作成
     - スタッフを選択
     - 勤務日と時間を入力
     - 備考を入力（任意）
     - 「シフトを作成」ボタンをクリック
   - 作成済みシフトの一覧表示
   - 不要なシフトは削除可能
5. **ユーザー管理タブ**
   - 新規ユーザーの追加
     - 「新しいユーザーを追加」ボタンをクリック
     - ユーザー名、役割、パスワードを入力
     - 「保存」ボタンをクリック
   - 既存ユーザーの編集
     - 「編集」ボタンをクリック
     - モーダルで情報を変更して「保存」
   - ユーザーの削除
     - 「削除」ボタンをクリック
     - 関連するシフトも自動的に削除されます
6. **カレンダータブ**
   - 未承認の希望シフトと承認済み・確定シフトを別々に表示
   - 月間カレンダーで全スタッフのシフトを一覧確認
   - 各日付に名前と時間が表示されます

## データ構造

### users テーブル
- `id`: ユーザーID
- `name`: ユーザー名
- `role`: 役割（staff=スタッフ, admin=管理者）
- `password`: パスワード

### shift_requests テーブル
- `id`: リクエストID
- `user_id`: 提出したユーザーのID
- `user_name`: 提出したユーザーの名前
- `date`: 希望日（YYYY-MM-DD形式）
- `time_slots`: 希望時間帯の配列
- `status`: ステータス（pending=未確定, approved=承認済み）
- `notes`: 備考・メモ

### shifts テーブル
- `id`: シフトID
- `user_id`: 割り当てられたユーザーのID
- `user_name`: 割り当てられたユーザーの名前
- `date`: 勤務日（YYYY-MM-DD形式）
- `start_time`: 開始時刻（HH:MM形式）
- `end_time`: 終了時刻（HH:MM形式）
- `is_confirmed`: 確定フラグ
- `notes`: 備考・メモ

## 技術スタック

- **フロントエンド**: HTML5, CSS3, Vanilla JavaScript
- **データ管理**: RESTful Table API
- **デザイン**: レスポンシブデザイン（モバイルファースト）
- **認証**: パスワード認証 + localStorage によるセッション管理
- **パフォーマンス最適化**: 
  - データキャッシュ機構（30秒間保持）
  - 日付マッピングによる高速フィルタリング
  - 不要なAPIリクエストの削減

## ファイル構成

```
/
├── index.html          # ログイン画面
├── staff.html          # スタッフページ
├── admin.html          # 管理者ページ
├── css/
│   └── style.css       # スタイルシート
├── js/
│   ├── login.js        # ログイン処理
│   ├── staff.js        # スタッフページの処理
│   └── admin.js        # 管理者ページの処理
└── README.md           # このファイル
```

## 機能拡張の推奨事項

### 次のステップとして実装可能な機能
1. **通知機能**
   - シフト確定時の通知表示
   - 新しい希望シフト提出時の管理者への通知

2. **統計・レポート機能**
   - スタッフごとの勤務時間集計
   - 月次レポート出力

3. **シフトパターン登録**
   - よく使う時間帯をテンプレート化
   - ワンクリックでシフト作成

4. **エクスポート機能**
   - シフト表のPDF出力
   - CSV形式でのエクスポート

5. **勤務実績管理**
   - 実際の出勤・退勤時刻の記録
   - 予定と実績の比較

## 制限事項

### 認証について
パスワードは平文で保存されています。これは静的Webサイトの制限によるもので、本格的な暗号化やハッシュ化は実装できません。実運用では十分なセキュリティとは言えませんが、デモ環境や小規模な内部利用には適しています。

### リアルタイム更新
ページ更新時にデータを取得する方式のため、リアルタイムでの自動更新はありません。最新情報を確認するには「更新」ボタンをクリックするか、ページを再読み込みしてください。

### サーバーサイド処理
バックエンドサーバーは使用していないため、複雑なビジネスロジックや大規模なデータ処理には対応していません。

## デザインの特徴

- **モバイルファースト**: スマートフォンでの操作を最優先
- **直感的なUI**: 誰でも簡単に操作できるシンプルなデザイン
- **視覚的フィードバック**: ボタンやカードのホバーエフェクト
- **カラフルなグラデーション**: 親しみやすい配色

## 主要な更新内容

### v2.0.0（最新版）
- パスワード認証の追加
- 希望シフトの時間選択を30分単位に変更（9:30-18:00）
- 管理者によるユーザー管理機能の追加
- シフト調整機能の追加（時間帯の編集）
- 承認取り消し機能の追加
- カレンダー表示機能の追加（スタッフ・管理者両方）
- 絵文字の削除（シンプルなデザイン）

### v1.0.0
- 基本的なシフト管理機能
- 希望シフトの提出・確認
- シフトの作成・削除

---

**開発日**: 2026年1月
**バージョン**: 2.0.0
